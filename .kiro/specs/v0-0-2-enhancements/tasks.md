# 구현 계획

- [x] 1. 핵심 서비스 구현
  - AgentLocationService와 ExperimentalToolsService를 구현하여 새로운 기능의 기반을 마련
  - 로컬/글로벌 에이전트 위치 관리와 실험적 도구 식별 로직 구현
  - _요구사항: 2.2, 2.3, 2.4, 1.2, 1.3_

- [x] 1.1 AgentLocationService 구현
  - 로컬과 글로벌 에이전트 디렉토리 경로 관리 기능 구현
  - 디렉토리 자동 생성 및 권한 검증 로직 작성
  - 에이전트 이름 충돌 감지 및 우선순위 처리 메서드 구현
  - _요구사항: 2.2, 2.3, 2.4, 2.6_

- [x] 1.2 ExperimentalToolsService 구현
  - Q CLI 실험적 기능 도구 목록 정의 (knowledge, thinking, todo_list)
  - 실험적 도구 식별 및 정보 제공 메서드 구현
  - 실험적 기능 경고 메시지 생성 로직 작성
  - _요구사항: 1.2, 1.3, 1.4_

- [x] 2. 타입 정의 확장
  - 기존 타입 시스템을 확장하여 새로운 기능을 지원하는 타입 정의 추가
  - 에이전트 위치 정보와 실험적 도구 관련 타입 구현
  - _요구사항: 2.1, 1.1_

- [x] 2.1 AgentLocation 및 관련 타입 정의
  - AgentLocation enum과 AgentConflictInfo 인터페이스 작성
  - AgentItemWithLocation 인터페이스로 기존 AgentItem 확장
  - 위치별 에이전트 관리를 위한 타입 정의 추가
  - _요구사항: 2.1, 2.5_

- [x] 2.2 실험적 도구 타입 정의
  - ExperimentalTool 인터페이스와 관련 타입 정의 작성
  - ToolSection 인터페이스로 도구 섹션 구분 지원
  - EnhancedAgentFormData로 기존 폼 데이터 확장
  - _요구사항: 1.1, 1.2_

- [x] 3. 에이전트 관리 서비스 개선
  - 기존 AgentManagementService를 확장하여 다중 위치 에이전트 지원
  - 로컬과 글로벌 에이전트를 통합 관리하는 로직 구현
  - _요구사항: 2.1, 2.5_

- [x] 3.1 다중 위치 에이전트 로딩 구현
  - 로컬과 글로벌 디렉토리에서 에이전트 목록을 병렬로 로드하는 기능 구현
  - 에이전트 위치 정보를 포함한 통합 목록 생성 로직 작성
  - 캐싱 전략을 적용한 성능 최적화 구현
  - _요구사항: 2.5_

- [x] 3.2 이름 충돌 처리 로직 구현
  - 동일한 이름의 로컬/글로벌 에이전트 충돌 감지 기능 구현
  - 로컬 에이전트 우선순위 적용 및 사용자 경고 표시 로직 작성
  - 충돌 해결을 위한 사용자 인터페이스 지원 구현
  - _요구사항: 2.6_

- [x] 4. 에이전트 생성 폼 서비스 개선
  - AgentCreationFormService를 확장하여 글로벌 에이전트 생성 지원
  - 실험적 도구 분리 표시 및 검증 로직 구현
  - _요구사항: 2.2, 1.1, 1.5_

- [x] 4.1 글로벌 에이전트 생성 지원
  - 에이전트 위치 선택에 따른 저장 경로 결정 로직 구현
  - 글로벌 디렉토리 자동 생성 및 권한 검증 기능 추가
  - 위치별 에이전트 생성 검증 로직 구현
  - _요구사항: 2.2, 2.7_

- [x] 4.2 실험적 도구 처리 로직 구현
  - 도구 목록에서 실험적 도구 분리 및 분류 기능 구현
  - 실험적 도구 선택 시 경고 및 검증 로직 작성
  - 폼 데이터에 실험적 도구 정보 포함하는 기능 구현
  - _요구사항: 1.1, 1.4, 1.5_

- [x] 5. 에이전트 트리 프로바이더 개선
  - 기존 AgentTreeProvider를 확장하여 로컬/글로벌 구분 표시 지원
  - 계층적 트리 구조로 에이전트 위치별 그룹화 구현
  - _요구사항: 3.1, 3.2, 3.5_

- [x] 5.1 위치별 트리 구조 구현
  - "로컬 에이전트"와 "글로벌 에이전트" 카테고리 섹션 생성
  - LocationSeparatorItem을 통한 계층적 트리 구조 구현
  - 각 섹션별 에이전트 목록 표시 및 관리 기능 구현
  - _요구사항: 3.1, 3.2_

- [x] 5.2 충돌 표시 및 빈 상태 처리
  - 이름 충돌이 있는 에이전트에 대한 시각적 경고 표시 구현
  - ConflictWarningItem을 통한 충돌 정보 표시 기능 구현
  - 각 위치별 빈 상태 메시지 및 안내 표시 구현
  - _요구사항: 3.3, 3.4, 3.5_

- [x] 6. 에이전트 생성 웹뷰 UI 개선
  - 기존 웹뷰를 확장하여 위치 선택과 실험적 도구 분리 표시 지원
  - 사용자 친화적인 인터페이스로 새로운 기능 제공
  - _요구사항: 1.1, 1.3, 2.2_

- [x] 6.1 에이전트 위치 선택 UI 구현
  - 라디오 버튼을 통한 로컬/글로벌 위치 선택 인터페이스 구현
  - 각 위치 옵션에 대한 설명 및 안내 메시지 표시 기능 구현
  - 위치 선택에 따른 폼 검증 및 피드백 로직 구현
  - _요구사항: 2.2_

- [x] 6.1.1 웹뷰 HTML에 위치 선택 섹션 추가
  - agentCreationWebviewProvider.ts의 getWebviewContent() 메서드에 위치 선택 HTML 추가
  - "Basic Properties" 섹션 다음에 "Agent Location" 섹션 삽입
  - 로컬/글로벌 라디오 버튼과 설명 텍스트 구현
  - _요구사항: 2.2_

- [x] 6.1.2 위치 선택 JavaScript 로직 구현
  - 웹뷰 JavaScript에 위치 선택 이벤트 핸들러 추가
  - formData.location 필드 업데이트 로직 구현
  - 위치 변경 시 실시간 검증 및 UI 업데이트 구현
  - _요구사항: 2.2_

- [ ] 6.2 실험적 도구 분리 표시 UI 구현
  - 일반 도구와 실험적 도구를 별도 섹션으로 분리하여 표시
  - 실험적 도구 섹션에 경고 메시지 및 안정성 정보 표시
  - 실험적 도구 선택 시 추가 확인 및 안내 기능 구현
  - _요구사항: 1.1, 1.3, 1.4_

- [x] 6.2.1 웹뷰 HTML에 실험적 도구 섹션 추가
  - 기존 tools-container를 확장하여 일반/실험적 도구 섹션 분리
  - 실험적 도구 섹션에 경고 배지와 안내 메시지 HTML 추가
  - CSS 스타일링으로 실험적 도구 섹션 시각적 구분 구현
  - _요구사항: 1.1, 1.3_

- [x] 6.2.2 실험적 도구 렌더링 JavaScript 로직 구현
  - renderTools() 함수를 수정하여 도구 분류별 렌더링 지원
  - 실험적 도구 선택 시 추가 확인 다이얼로그 구현
  - 도구 섹션별 토글 및 상태 관리 로직 추가
  - _요구사항: 1.4, 1.5_

- [x] 7. 메시지 프로토콜 확장
  - 웹뷰와 확장 프로그램 간 통신을 위한 메시지 타입 확장
  - 새로운 기능을 지원하는 메시지 처리 로직 구현
  - _요구사항: 1.5, 2.2_

- [x] 7.1 위치 선택 메시지 처리
  - 에이전트 위치 선택 정보를 포함한 메시지 타입 정의
  - 위치 변경 시 실시간 검증 및 피드백 메시지 처리 구현
  - 위치별 에이전트 생성 요청 처리 로직 구현
  - _요구사항: 2.2_

- [x] 7.2 실험적 도구 관련 메시지 처리
  - 실험적 도구 정보 요청 및 응답 메시지 타입 정의
  - 실험적 도구 선택 시 경고 및 확인 메시지 처리 구현
  - 도구 분류 정보를 포함한 초기 데이터 전송 로직 구현
  - _요구사항: 1.1, 1.4_

- [x] 8. 단위 테스트 구현
  - 새로 구현된 서비스와 기능에 대한 포괄적인 단위 테스트 작성
  - 기존 테스트 케이스 업데이트 및 새로운 시나리오 추가
  - _요구사항: 모든 요구사항_

- [x] 8.1 AgentLocationService 테스트
  - 로컬/글로벌 경로 해결 로직 테스트 케이스 작성
  - 디렉토리 생성 및 권한 처리 테스트 구현
  - 이름 충돌 감지 및 우선순위 처리 테스트 작성
  - _요구사항: 2.2, 2.3, 2.4, 2.6_

- [x] 8.2 ExperimentalToolsService 테스트
  - 실험적 도구 식별 로직 테스트 케이스 작성
  - 도구 정보 반환 및 경고 메시지 생성 테스트 구현
  - 도구 분류 및 필터링 기능 테스트 작성
  - _요구사항: 1.2, 1.3, 1.4_

- [x] 9. 통합 테스트 구현
  - 전체 워크플로우에 대한 통합 테스트 시나리오 작성
  - 사용자 시나리오 기반 end-to-end 테스트 구현
  - _요구사항: 모든 요구사항_

- [x] 9.1 에이전트 생성 워크플로우 테스트
  - 로컬 에이전트 생성 전체 프로세스 테스트 구현
  - 글로벌 에이전트 생성 전체 프로세스 테스트 구현
  - 이름 충돌 시나리오 및 해결 과정 테스트 작성
  - _요구사항: 2.2, 2.6, 2.7_

- [x] 9.2 트리 뷰 표시 및 상호작용 테스트
  - 로컬/글로벌 구분 표시 기능 테스트 구현
  - 충돌 경고 표시 및 빈 상태 처리 테스트 작성
  - 트리 뷰 상호작용 및 컨텍스트 메뉴 테스트 구현
  - _요구사항: 3.1, 3.2, 3.3, 3.4, 3.5_

- [x] 10. 문서 업데이트
  - README.md 파일을 업데이트하여 새로운 기능 문서화
  - 변경사항 및 사용법 가이드 추가
  - _요구사항: 4.1, 4.2, 4.3, 4.4, 4.5_

- [x] 10.1 README.md 기능 문서화
  - v0.0.2 새로운 기능 섹션 추가 및 상세 설명 작성
  - 실험적 기능 도구 지원에 대한 설명 및 주의사항 문서화
  - 글로벌 에이전트 지원 기능 및 사용 시나리오 설명 추가
  - _요구사항: 4.3, 4.4_

- [x] 10.2 "What's Changed" 섹션 추가
  - v0.0.2 변경사항을 정리한 "What's Changed" 섹션 작성
  - 새로운 기능, 개선사항, 버그 수정 내용 정리
  - 사용자 가이드 및 마이그레이션 정보 포함
  - _요구사항: 4.2, 4.5_

## 추가 작업 필요 (미완성 구현)

- [ ] 11. 글로벌/로컬 에이전트 통합 완성
  - AgentLocationService가 구현되어 있지만 실제 서비스에서 사용되지 않는 문제 해결
  - AgentConfigService와 AgentManagementService에 글로벌 에이전트 지원 통합
  - _요구사항: 2.1, 2.5_

- [ ] 11.1 AgentConfigService 글로벌 지원 통합
  - scanAgentFiles() 메서드를 로컬과 글로벌 디렉토리 모두 스캔하도록 수정
  - AgentLocationService를 의존성으로 추가하여 다중 위치 지원
  - 에이전트 생성/삭제 시 위치 정보 고려하도록 수정
  - _요구사항: 2.2, 2.3, 2.4_

- [ ] 11.2 AgentManagementService 다중 위치 지원 완성
  - getAgentList()에서 로컬과 글로벌 에이전트를 모두 로드하도록 수정
  - 에이전트 아이템에 위치 정보(local/global) 추가
  - 이름 충돌 감지 및 우선순위 처리 로직 적용
  - _요구사항: 2.5, 2.6_

- [x] 11.3 트리뷰 위치별 구분 표시 구현
  - AgentTreeProvider에서 로컬/글로벌 에이전트를 구분하여 표시
  - LocationSeparatorItem을 사용한 계층적 구조 구현
  - 충돌 에이전트에 대한 시각적 경고 표시
  - _요구사항: 3.1, 3.2, 3.3_

- [ ] 11.4 에이전트 생성 폼 위치 선택 기능 연결
  - 웹뷰에서 선택한 위치 정보를 실제 에이전트 생성에 반영
  - AgentCreationFormService에서 위치별 저장 경로 처리
  - 글로벌 디렉토리 자동 생성 및 권한 검증 적용
  - _요구사항: 2.2, 2.7_